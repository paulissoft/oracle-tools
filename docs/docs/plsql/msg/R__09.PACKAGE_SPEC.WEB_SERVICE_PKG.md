<!-- DO NOT EDIT THIS FILE DIRECTLY - it is generated from source file db/app/msg/src/full/R__09.PACKAGE_SPEC.WEB_SERVICE_PKG.sql -->
<!-- markdownlint-disable MD003 MD012 MD024 MD033 -->

Invoke web services
===================

- [Package "WEB_SERVICE_PKG"](#package-web_service_pkg)
- [Procedure to_json](#procedure-to_json)
- [Procedure to_json](#procedure-to_json-1)
- [Function make_rest_request](#function-make_rest_request)


## Package "WEB_SERVICE_PKG"

A package introduced to prive backwards compability with APEX_WEB_SERVICE, i.e. functions and procedures for web services.

The usual way of invoking a web service via APEX_WEB_SERVICE (procedure names are the same for this package and APEX_WEB_SERVICE):

1. invoke `clear_request_headers`
2. invoke `set_request_headers`
3. invoke `make_rest_request`

New in this package is:

4. invoke handle_response and if there is an exception (for instance HTTP status code not 2XX) you may need to retry, i.e. return to point 3

But in order to use just one `make_rest_request` call the function below where there is no need to invoke `set_request_headers`:

```
function make_rest_request
( p_request in rest_web_service_request_typ -- The request
, p_username in varchar2 default null -- The username if basic authentication is required for this service
, p_password in varchar2 default null -- The password if basic authentication is required for this service
, p_wallet_pwd in varchar2 default null -- The password to access the wallet
)
return web_service_response_typ;
```

The response to a `make_rest_request` is an object with all the data from the HTTP response.

See also [APEX_WEB_SERVICE The Definitive Guide](https://blog.cloudnueva.com/apexwebservice-the-definitive-guide).

SIGNATURE

```sql
PACKAGE "WEB_SERVICE_PKG" AUTHID DEFINER AS
```


## Procedure to_json

Convert a HTTP cookie table to a JSON array.

SIGNATURE

```sql
procedure to_json
( p_cookie_tab in http_cookie_tab_typ
, p_cookies out nocopy json_array_t
);
```


## Procedure to_json

Convert a HTTP header table to a JSON array.

SIGNATURE

```sql
procedure to_json
( p_http_header_tab in property_tab_typ
, p_http_headers out nocopy json_array_t
);
```


## Function make_rest_request

Make a REST request and return the response object.

SIGNATURE

```sql
function make_rest_request
( p_request in rest_web_service_request_typ -- The request
, p_username in varchar2 default null -- The username if basic authentication is required for this service
, p_password in varchar2 default null -- The password if basic authentication is required for this service
, p_wallet_pwd in varchar2 default null -- The password to access the wallet
)
return web_service_response_typ;
```


